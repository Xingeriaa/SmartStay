@model IEnumerable<do_an_tot_nghiep.Models.PhongTro>

@{
    ViewData["Title"] = "Quản lý danh sách phòng trọ";
    Layout = "~/Views/Shared/_Layout.cshtml";

    // --- SERVER SIDE LOGIC ---
    var totalRooms = Model != null ? Model.Count() : 0;
    var emptyRooms = Model != null ? Model.Count(x => x.SoLuongNguoi == 0) : 0;
    var totalCapacity = Model != null && Model.Any() ? Model.Sum(x => x.SoLuongNguoi) : 0;
    var avgPrice = Model != null && Model.Any() ? Model.Average(x => x.GiaPhong) : 0;
    System.Globalization.CultureInfo cul = System.Globalization.CultureInfo.GetCultureInfo("vi-VN");
    var currentNhaId = ViewBag.SelectedNhaId;
}

<style>
    :root {
        --main-gradient: var(--brand-gradient);
        --primary-color: var(--brand-600);
        --primary-light: rgba(0, 184, 148, 0.12);
        --primary-dark: var(--accent-600);
        --secondary-color: var(--ink-600);
        --dark-color: var(--ink-900);
        --light-gray: var(--bg-body);
        --white: var(--bg-surface);
        --card-border-radius: 16px;
        --card-shadow: 0 10px 30px 0 rgba(0, 184, 148, 0.08);
        --card-hover-shadow: 0 15px 35px 0 rgba(0, 184, 148, 0.18);
        --transition-speed: 0.3s;
        --table-header-bg: #f8f9fa;
        --table-border-color: #eff2f7;
    }

    /* --- General Reset & Typography --- */
    .room-manager-container {
        font-family: 'Inter', 'Segoe UI', Helvetica, Arial, sans-serif;
        background-color: var(--bg-body);
        min-height: 100vh;
        padding-bottom: 50px;
        color: #555;
    }

        .room-manager-container h1, .room-manager-container h2,
        .room-manager-container h3, .room-manager-container h4,
        .room-manager-container h5, .room-manager-container h6 {
            color: var(--dark-color);
            font-weight: 700;
        }

    /* --- Animations (Giữ nguyên) --- */
    @@keyframes fadeInUp {
        from

    {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }

    }

    .animate-fade-in {
        animation: fadeInUp 0.5s ease-out forwards;
    }

    /* --- Components: Cards --- */
    .custom-card {
        background: var(--white);
        border: none;
        border-radius: var(--card-border-radius);
        box-shadow: var(--card-shadow);
        transition: all var(--transition-speed) ease;
        margin-bottom: 1.5rem;
        position: relative;
        overflow: hidden;
    }

        .custom-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
        }

    /* --- Stats Cards Specifics --- */
    .stat-card {
        padding: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .stat-icon-wrapper {
        width: 60px;
        height: 60px;
        border-radius: 16px; /* Bo góc mềm hơn thay vì tròn hoàn toàn */
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: white;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    /* ĐỒNG BỘ MÀU SẮC: Tất cả icon thống kê đều dùng Gradient Tím */
    .bg-gradient-primary,
    .bg-gradient-success,
    .bg-gradient-warning,
    .bg-gradient-danger {
        background: var(--main-gradient) !important;
    }

    .stat-content h3 {
        font-size: 2rem;
        margin-bottom: 0;
        font-weight: 800;
        color: #333;
    }

    .stat-content p {
        margin-bottom: 0;
        color: var(--secondary-color);
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 600;
    }

    /* --- Toolbar Section --- */
    .toolbar-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--white);
        border-radius: var(--card-border-radius);
        box-shadow: var(--card-shadow);
        margin-bottom: 2rem;
    }

    .filter-group {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-grow: 1;
    }

    .search-box {
        position: relative;
        min-width: 300px;
    }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 50px;
            background-color: #f9fafb;
            transition: all 0.3s;
        }

            .search-box input:focus {
                outline: none;
                border-color: var(--primary-color);
                background-color: white;
                box-shadow: 0 0 0 3px rgba(0, 184, 148, 0.15);
            }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

    /* --- Buttons (Theme Gradient) --- */
    .btn-action {
        padding: 0.6rem 1.2rem;
        border-radius: 10px;
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        text-decoration: none !important;
    }

    .btn-new {
        background: var(--main-gradient); /* Dùng Gradient */
        color: white;
        box-shadow: 0 4px 10px rgba(0, 184, 148, 0.3);
    }

        .btn-new:hover {
            background: var(--main-gradient);
            opacity: 0.9;
            transform: translateY(-2px);
            color: white;
        }

    .btn-edit-tool {
        background-color: var(--white);
        color: var(--dark-color);
        border: 1px solid #e0e0e0;
    }

        .btn-edit-tool:hover {
            background-color: var(--primary-light);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

    .btn-delete-tool {
        background-color: #fff2f2;
        color: #fc5a5a;
        border: 1px solid transparent;
    }

        .btn-delete-tool:hover {
            background-color: #ffe5e5;
            transform: translateY(-2px);
        }

    /* --- Table Design --- */
    .table-responsive-custom {
        border-radius: var(--card-border-radius);
        overflow: hidden;
    }

    .modern-table {
        width: 100%;
        border-collapse: collapse;
        white-space: nowrap;
    }

        .modern-table thead {
            background-color: #f8f9fa;
        }

        .modern-table th {
            padding: 1.2rem 1rem;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.8rem;
            color: var(--primary-color); /* Header chữ tím */
            border-bottom: 2px solid var(--table-border-color);
            text-align: left;
        }

        .modern-table td {
            padding: 1rem;
            vertical-align: middle;
            border-bottom: 1px solid var(--table-border-color);
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .modern-table tbody tr {
            transition: background-color 0.2s;
        }

            .modern-table tbody tr:hover {
                background-color: var(--primary-light); /* Hover màu tím nhạt */
            }

    /* Column Specifics */
    .col-checkbox {
        width: 50px;
        text-align: center !important;
    }

    .room-image-thumb {
        width: 80px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        border: 1px solid #dee2e6;
    }

    .room-name {
        font-weight: 700;
        color: var(--primary-color); /* Tên phòng màu tím */
        font-size: 1rem;
        margin-bottom: 0.2rem;
    }

    .room-location {
        font-size: 0.8rem;
        color: #999;
    }

    /* Giá tiền dùng Gradient text */
    .price-tag {
        font-weight: 800;
        background: var(--main-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 1.1rem;
    }

    .deposit-text {
        font-size: 0.75rem;
        color: #999;
        font-style: italic;
    }

    /* Badges */
    .badge-custom {
        padding: 0.4em 0.8em;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .badge-furniture-full {
        background-color: rgba(0, 184, 148, 0.12);
        color: var(--primary-color);
        border: 1px solid rgba(0, 184, 148, 0.25);
    }

    .badge-furniture-basic {
        background-color: rgba(9, 132, 227, 0.12);
        color: var(--accent-600);
        border: 1px solid rgba(9, 132, 227, 0.25);
    }

    .badge-furniture-none {
        background-color: var(--light-gray);
        color: var(--secondary-color);
    }

    .service-tag {
        display: inline-block;
        background: #fff;
        color: var(--ink-600);
        padding: 3px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        margin-right: 4px;
        margin-bottom: 4px;
        border: 1px solid var(--border-color);
    }

    /* Checkbox Custom Theme */
    .custom-control-input {
        width: 18px;
        height: 18px;
        cursor: pointer;
        accent-color: var(--primary-color);
    }

    /* Pagination Active State */
    .page-item.active .page-link {
        background: var(--main-gradient);
        border-color: transparent;
        color: white;
    }

    .page-link {
        color: var(--primary-color);
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
    }

    .empty-state-icon {
        font-size: 4rem;
        color: #dee2e6;
        margin-bottom: 1rem;
    }

    .fab-container {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 999;
        display: none;
    }

    @@media (max-width: 768px) {
        .stat-card

    {
        margin-bottom: 1rem;
    }

    .toolbar-container {
        flex-direction: column;
        align-items: stretch;
    }

    .search-box {
        min-width: 100%;
    }

    .action-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 1rem;
    }

    .fab-container {
        display: block;
    }

    .hide-mobile {
        display: none;
    }

    }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<div class="room-manager-container container-fluid py-4">

    <div class="row mb-4 animate-fade-in">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <div>
                <h2 class="mb-1 text-gradient">Quản Lý Phòng Trọ</h2>
                <p class="text-muted mb-0">Hệ thống quản lý, theo dõi tình trạng và thông tin phòng</p>
            </div>
            <div class="date-display text-end d-none d-md-block">
                <h5 class="mb-0 text-brand">@DateTime.Now.ToString("dd/MM/yyyy")</h5>
                <small class="text-muted">@DateTime.Now.ToString("dddd")</small>
            </div>
        </div>
    </div>

    <div class="row mb-4 animate-fade-in" style="animation-delay: 0.1s;">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="custom-card stat-card">
                <div class="stat-content">
                    <p>Tổng số phòng</p>
                    <h3>@totalRooms</h3>
                </div>
                <div class="stat-icon-wrapper bg-gradient-primary">
                    <i class="bi bi-building"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="custom-card stat-card">
                <div class="stat-content">
                    <p>Phòng trống</p>
                    <h3 class="@(emptyRooms > 0 ? "" : "text-muted")" style="@(emptyRooms > 0 ? "color: var(--primary-dark)" : "")">@emptyRooms</h3>
                </div>
                <div class="stat-icon-wrapper bg-gradient-success">
                    <i class="bi bi-check-circle"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="custom-card stat-card">
                <div class="stat-content">
                    <p>Giá TB / Phòng</p>
                    <h3>@avgPrice.ToString("#,##0") <small style="font-size: 1rem; color: #999">đ</small></h3>
                </div>
                <div class="stat-icon-wrapper bg-gradient-warning">
                    <i class="bi bi-cash-stack"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="custom-card stat-card">
                <div class="stat-content">
                    <p>Tổng sức chứa</p>
                    <h3>@totalCapacity <small style="font-size: 1rem; color: #999">người</small></h3>
                </div>
                <div class="stat-icon-wrapper bg-gradient-danger">
                    <i class="bi bi-people-fill"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="row animate-fade-in" style="animation-delay: 0.2s;">
        <div class="col-12">
            <div class="toolbar-container">
                <div class="filter-group">
                    <div class="d-flex flex-column">
                        <label class="small text-muted fw-bold mb-1">Chọn nhà trọ:</label>
                        <select class="form-select" id="selectNhaTro" style="min-width: 220px; font-weight: 500;" onchange="changeNhaTro(this)">
                            <option value="">-- Tất cả nhà trọ --</option>
                            @if (ViewBag.DanhSachNha != null)
                            {
                                foreach (var item in (List<do_an_tot_nghiep.Models.NhaTro>)ViewBag.DanhSachNha)
                                {
                                    <option value="@item.Id" selected="@(ViewBag.SelectedNhaId?.ToString() == item.Id.ToString())">
                                        @item.TenNhaTro
                                    </option>
                                }
                            }
                        </select>
                    </div>

                    <div class="search-box ms-md-3 mt-3 mt-md-0">
                        <i class="bi bi-search"></i>
                        <input type="text" id="searchInput" placeholder="Tìm kiếm phòng..." onkeyup="searchTable()">
                    </div>
                </div>

                <div class="action-buttons">
                    @if (ViewBag.SelectedNhaId != null)
                    {
                        <a href="/QuanLyPhong/Create?nhaId=@ViewBag.SelectedNhaId" class="btn-action btn-new">
                            <i class="bi bi-plus-lg"></i> Thêm mới
                        </a>
                    }
                    else
                    {
                        <button class="btn-action btn-new opacity-50" onclick="alertSelectHouseFirst()" style="cursor: not-allowed;">
                            <i class="bi bi-plus-lg"></i> Thêm mới
                        </button>
                    }

                    <button class="btn-action btn-edit-tool ms-2" onclick="editSelected()">
                        <i class="bi bi-pencil-square"></i> Sửa
                    </button>

                    <button class="btn-action btn-delete-tool ms-2" onclick="confirmDeleteMultiple()">
                        <i class="bi bi-trash"></i> Xóa
                    </button>

                    <button class="btn-action btn-edit-tool ms-2" onclick="window.location.reload()" title="Tải lại trang">
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="row animate-fade-in" style="animation-delay: 0.3s;">
        <div class="col-12">
            <div class="custom-card table-card">
                <div class="table-responsive-custom">
                    <table class="modern-table" id="dataTable">
                        <thead>
                            <tr>
                                <th class="col-checkbox">
                                    <input type="checkbox" id="checkAll" class="custom-control-input" onclick="toggleAll(this)">
                                </th>
                                <th style="width: 120px;">Hình ảnh</th>
                                <th>Thông tin phòng</th>
                                <th>Chi phí</th>
                                <th>Diện tích & Sức chứa</th>
                                <th>Nội thất & Tiện ích</th>
                                <th style="width: 200px;">Dịch vụ</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model != null && Model.Any())
                            {
                                foreach (var item in Model)
                                {
                                    <tr class="room-row">
                                        <td class="col-checkbox">
                                            <input type="checkbox" class="room-checkbox custom-control-input" value="@item.Id" data-name="@item.TenPhong">
                                        </td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(item.AnhPhong))
                                            {
                                                <img src="@item.AnhPhong" alt="Room" class="room-image-thumb" onerror="this.src='https://via.placeholder.com/80x60?text=No+Img'">
                                            }
                                            else
                                            {
                                                <div class="room-image-thumb d-flex align-items-center justify-content-center bg-light text-muted">
                                                    <i class="bi bi-image fs-4"></i>
                                                </div>
                                            }
                                        </td>
                                        <td>
                                            <div class="room-name">@item.TenPhong</div>
                                            <div class="room-location mb-1">
                                                <i class="bi bi-layers-fill me-1"></i>Tầng: @item.Tang
                                            </div>
                                            <a asp-action="Details"
                                               asp-route-id="@item.Id"
                                               class="btn btn-sm mt-1 btn-outline-brand">
                                                <i class="bi bi-eye"></i> Chi tiết
                                            </a>
                                        </td>
                                        <td>
                                            <div class="price-tag">@item.GiaPhong.ToString("#,##0") ₫</div>
                                            <div class="deposit-text">Cọc: @(item.TienCoc > 0 ? item.TienCoc.ToString("#,##0") + " đ" : "Không cọc")</div>
                                        </td>
                                        <td>
                                            <div class="mb-1"><i class="bi bi-aspect-ratio me-1 text-muted"></i> <strong>@item.DienTich</strong> m²</div>
                                            <div><i class="bi bi-people me-1 text-muted"></i> Tối đa <strong>@item.SoLuongNguoi</strong> người</div>
                                        </td>
                                        <td>
                                            @{
                                                string badgeClass = "badge-furniture-none";
                                                string iconClass = "bi-box-seam";
                                                if (item.NoiThat != null)
                                                {
                                                    if (item.NoiThat.Contains("Đầy đủ") || item.NoiThat.ToLower().Contains("full")) { badgeClass = "badge-furniture-full"; iconClass = "bi-stars"; }
                                                    else if (item.NoiThat.Contains("Cơ bản")) { badgeClass = "badge-furniture-basic"; iconClass = "bi-lamp"; }
                                                }
                                            }
                                            <span class="badge-custom @badgeClass mb-1">
                                                <i class="bi @iconClass me-1"></i> @(string.IsNullOrEmpty(item.NoiThat) ? "Trống" : item.NoiThat)
                                            </span>
                                        </td>
                                        <td style="white-space: normal;">
                                            @if (!string.IsNullOrEmpty(item.DichVu))
                                            {
                                                var services = item.DichVu.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
                                                if (services.Any())
                                                {
                                                    foreach (var sv in services.Take(3))
                                                    {
                                                        <span class="service-tag">@sv.Trim()</span>
                                                    }
                                                    if (services.Length > 3)
                                                    {
                                                        <span class="service-tag text-brand">...@(services.Length - 3)+</span>
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                <span class="text-muted small fs-italic">Không có dịch vụ</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="7">
                                        <div class="empty-state">
                                            <i class="bi bi-folder-x empty-state-icon"></i>
                                            <h4>Không tìm thấy dữ liệu</h4>
                                            <p class="text-muted">Chưa có phòng nào được thêm vào danh sách này.</p>
                                            @if (ViewBag.SelectedNhaId != null)
                                            {
                                                <a href="/QuanLyPhong/Create?nhaId=@ViewBag.SelectedNhaId" class="btn btn-new mt-3">
                                                    <i class="bi bi-plus-circle me-1"></i> Thêm phòng ngay
                                                </a>
                                            }
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

                @if (Model != null && Model.Count() > 0)
                {
                    <div class="d-flex justify-content-between align-items-center p-3 border-top">
                        <div class="small text-muted">
                            Hiển thị <strong>@Model.Count()</strong> kết quả
                        </div>
                        <nav aria-label="Page navigation">
                            <ul class="pagination pagination-sm mb-0 justify-content-end">
                                <li class="page-item disabled"><a class="page-link" href="#">Trước</a></li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">Sau</a></li>
                            </ul>
                        </nav>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    // --- 1. FILTER HOUSE LOGIC ---
    function changeNhaTro(selectObject) {
        var value = selectObject.value;
        Swal.fire({
            title: 'Đang tải dữ liệu...',
            text: 'Vui lòng chờ trong giây lát',
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });
        window.location.href = '/QuanLyPhong/Index?nhaId=' + value;
    }

    // --- 2. CHECKBOX LOGIC ---
    function toggleAll(source) {
        var checkboxes = document.querySelectorAll('.room-checkbox');
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = source.checked;
            highlightRow(checkboxes[i]);
        }
    }

    // Hiệu ứng highlight khi chọn row - DÙNG MÀU TÍM NHẠT
    function highlightRow(checkbox) {
        var row = checkbox.closest('tr');
        if (checkbox.checked) {
            row.style.backgroundColor = '#f4eefc'; // Tím nhạt
        } else {
            row.style.backgroundColor = '';
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        var checkboxes = document.querySelectorAll('.room-checkbox');
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                highlightRow(this);
                var allChecked = document.querySelectorAll('.room-checkbox:checked').length === checkboxes.length;
                document.getElementById('checkAll').checked = allChecked;
            });
        });
    });

    // --- 3. ALERT HELPERS ---
    function alertSelectHouseFirst() {
        Swal.fire({
            icon: 'info',
            title: 'Chưa chọn Nhà trọ',
            text: 'Vui lòng chọn một Nhà trọ từ danh sách lọc bên trên trước khi thêm phòng mới!',
            confirmButtonText: 'Đã hiểu',
            confirmButtonColor: '#00b894'
        });
    }

    // --- 4. EDIT LOGIC ---
    function editSelected() {
        var selected = document.querySelectorAll('.room-checkbox:checked');
        if (selected.length === 0) {
            Swal.fire({ icon: 'warning', title: 'Chưa chọn phòng', text: 'Vui lòng chọn 1 phòng để sửa thông tin.', confirmButtonColor: '#00b894' });
            return;
        }
        if (selected.length > 1) {
            Swal.fire({ icon: 'warning', title: 'Chọn quá nhiều', text: 'Chức năng sửa chỉ áp dụng cho 1 phòng tại một thời điểm.', confirmButtonColor: '#00b894' });
            return;
        }
        var id = selected[0].value;
        window.location.href = '/QuanLyPhong/Edit/' + id;
    }

    // --- 5. DELETE LOGIC ---
    function confirmDeleteMultiple() {
        const selected = document.querySelectorAll('.room-checkbox:checked');
        if (selected.length === 0) {
            Swal.fire('Thông báo', 'Bạn chưa chọn phòng nào', 'info');
            return;
        }
        const ids = Array.from(selected).map(x => parseInt(x.value));
        Swal.fire({
            title: 'Xác nhận xóa?',
            text: `Bạn có chắc muốn xóa ${ids.length} phòng?`,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Xóa',
            cancelButtonText: 'Hủy',
            confirmButtonColor: '#ff4757', // Giữ màu đỏ cho nút xóa
            cancelButtonColor: '#8c9097'
        }).then(result => {
            if (!result.isConfirmed) return;
            fetch('/QuanLyPhong/DeleteMultiple', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(ids)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    Swal.fire('Thành công', data.message, 'success').then(() => location.reload());
                } else {
                    Swal.fire('Lỗi', data.message, 'error');
                }
            })
            .catch(err => {
                Swal.fire('Lỗi', 'Không kết nối được server', 'error');
                console.error(err);
            });
        });
    }

    // --- 6. CLIENT SEARCH ---
    function searchTable() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("dataTable");
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            var found = false;
            var cols = [2, 3, 5];
            for(var c of cols) {
                td = tr[i].getElementsByTagName("td")[c];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                        break;
                    }
                }
            }
            if (found) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
</script>

<div class="fab-container">
    <div class="btn-group-vertical">
        <button class="btn rounded-circle shadow mb-2" style="width: 50px; height: 50px; background: var(--main-gradient); color: white; border: none;" onclick="window.scrollTo({top: 0, behavior: 'smooth'});">
            <i class="bi bi-arrow-up"></i>
        </button>
        @if (ViewBag.SelectedNhaId != null)
        {
            <a href="/QuanLyPhong/Create?nhaId=@ViewBag.SelectedNhaId" class="btn rounded-circle shadow d-flex align-items-center justify-content-center" style="width: 50px; height: 50px; background: white; color: var(--brand-600); border: 1px solid var(--brand-600);">
                <i class="bi bi-plus-lg fs-4"></i>
            </a>
        }
    </div>
</div>